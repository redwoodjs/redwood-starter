'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

const graphql = require('graphql');

const createFilterOperationTypeRule = (allowedOperations) => context => {
    const ops = new Set(allowedOperations);
    return {
        OperationDefinition(node) {
            if (!ops.has(node.operation)) {
                context.reportError(new graphql.GraphQLError(`GraphQL operation type "${node.operation}" is not allowed.`, [node]));
            }
        },
    };
};

const useFilterAllowedOperations = (allowedOperations) => {
    return {
        onValidate: ({ addValidationRule }) => {
            addValidationRule(createFilterOperationTypeRule(allowedOperations));
        },
    };
};

exports.createFilterOperationTypeRule = createFilterOperationTypeRule;
exports.useFilterAllowedOperations = useFilterAllowedOperations;
